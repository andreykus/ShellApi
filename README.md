Мониторинг системных процессов
=====================


Требования
--------

- python 3.6
- pywin32, для работы с COM объектами
- psutil, для работы с ситемными процессами


Установка
------------

- Установить зависимоcтей:
    
    pip install -r requirements.txt
	
- Деплоить приложение

	python setup.py install
	В каталоге питона появится модуль
		c:\Python36\Lib\site-packages\shell-0.1-py3.6.egg . Если нужно обновить - просто удалите данный файл, а потом снова соберите python setup.py install
		
- старт (`--debug=True`):

    python shell/monitor.py
	либо START.bat
	
	старт программы осуществляется от пользователя, имеющего права выгружать процессы Com сервера



Описание
-----------
### Что проверяем:
	Загрузка Процесса (CPU , MEMORY);
	Работа COM объекта: вызов методов:Authorize,GetCurrentSessionInfo. На корректность исполненния, на время исполненения
	
### Что делаем:
	Выгружаем процессы не входящием в метрики maxcpuprocent,maxmemoryprocent ;
	Выгружаем процессы с проверкой минимума историчности (время жизни минимума time_cache) по метрикам alarm_metric - событие генерится по ошибке исполненния метода com объекта, либо по превышению времени исполненния метода (witerezult)

### Конфигурация
Пример:

	[mail]
		#получатели сообщений
		recipients: akustov@bivgroup.com
		#отправитель сообщений
		sender: redmine@rybinsk.bivgroup.com
		#почтовый сервер
		host: 192.168.1.46
		port: 25
		user: redmine
		password: a
	[shellprocess]
		#имя процесса мониторинга
		name:dllhost.exe
		#интервал проверки (мс)
		delay: 120
		#максимальная загрузка процессора
		maxcpuprocent = 20
		#максимальная загрузка памяти
		maxmemoryprocent = 20
	[commethod]
		#имя подсиситемы в FA#
		sysname:ФронтОфис
		#интервал проверки (мс)
		delay: 120
		#время хранения показателей - кэш с вытеснением по времени
		time_cache: 10000
		#метрика выделения битого процесса (если показатели превышют минимальные показатели более чем)
		alarm_metric: 10
		#время ожидания ответа от FA#
		witerezult: 100
		#логин сиситемы FA#
		login: master1
		#пароль сиситемы FA#
		password:

